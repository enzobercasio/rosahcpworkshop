<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Create a Local Admin User for Cluster Access
  #

You can use built-in authentication to access your cluster immediately. This is done through the creation of a local privileged user.
ROSA makes this easy by providing a command to create a user, called cluster-admin, which has powerful cluster administration capabilities.
For production deployments, however, the recommended approach is to use an external identity provider to access the cluster. We will take you through an example of that in a later lab."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/docs/lab_3_access_cluster/"><meta property="og:site_name" content="ROSA HCP Workshop"><meta property="og:title" content="Access ROSA HCP Cluster"><meta property="og:description" content="Create a Local Admin User for Cluster Access # You can use built-in authentication to access your cluster immediately. This is done through the creation of a local privileged user.
ROSA makes this easy by providing a command to create a user, called cluster-admin, which has powerful cluster administration capabilities.
For production deployments, however, the recommended approach is to use an external identity provider to access the cluster. We will take you through an example of that in a later lab."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Lab 3 - Access ROSA HCP Cluster | ROSA HCP Workshop</title>
<link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=http://localhost:1313/docs/lab_3_access_cluster/><link rel=stylesheet href=/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.184ab0ba1ad480f500e7286e5b89e84a3efeb92b43ce0d91fe93f2e68bd397ec.js integrity="sha256-GEqwuhrUgPUA5yhuW4noSj7+uStDzg2R/pPy5ovTl+w=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>ROSA HCP Workshop</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/docs/lab_1_explore_rosa/>Lab 1 - Explore the environment</a></li><li><a href=/docs/lab_2_cluster_creation_hcp/>Lab 2 - Create a ROSA HCP Cluster</a></li><li><a href=/docs/lab_3_access_cluster/ class=active>Lab 3 - Access ROSA HCP Cluster</a></li><li><a href=/docs/lab_4_cluster_upgrade/>Lab 4 - Upgrade ROSA HCP Cluster</a></li><li><a href=/docs/lab_5_managing_worker_nodes-copy/>Lab 5 - Managing Worker Nodes</a></li><li><a href=/docs/lab_6_labeling_nodes/>Lab 6 - Labeling Worker Nodes</a></li><li><a href=/docs/lab_7_autoscaling/>Lab 7 - Autoscaling ROSA HCP Cluster</a></li><li><a href=/docs/lab_8_cloudwatch/>Lab 8 - Configure Red Hat OpenShift Logging with AWS Cloudwatch</a></li><li><a href=/docs/lab_9_deploy_app/>Lab 9 - Deploy an application with AWS Database</a></li><li><a href=/docs/lab_10_openshift_gitops/>Lab 10 - Deploy an application with Red Hat OpenShift GitOps</a></li><li><a href=/docs/lab_11_network_policy/>Lab 11 - Secure your applications with Network Policies</a></li><li><a href=/docs/lab_12_resilient_app/>Lab 12 - Make your application resilient</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Lab 3 - Access ROSA HCP Cluster</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#create-a-local-admin-user-for-cluster-access>Create a Local Admin User for Cluster Access</a></li><li><a href=#login-to-the-openshift-web-console>Login to the OpenShift Web Console</a></li></ul></nav></aside></header><article class="markdown book-article"><h2 id=create-a-local-admin-user-for-cluster-access>Create a Local Admin User for Cluster Access
<a class=anchor href=#create-a-local-admin-user-for-cluster-access>#</a></h2><p>You can use built-in authentication to access your cluster immediately. This is done through the creation of a local privileged user.</p><p>ROSA makes this easy by providing a command to create a user, called <code>cluster-admin</code>, which has powerful cluster administration capabilities.</p><p>For production deployments, however, the recommended approach is to use an external identity provider to access the cluster. We will take you through an example of that in a later lab.</p><ol><li><p>Run this command to create the local admin user</p><pre><code> rosa create admin --cluster rosa-${GUID}
</code></pre><p>Sample Output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tpl data-lang=tpl><span style=display:flex><span>I: Admin account has been added to cluster &#39;rosa-4fgbq&#39;.
</span></span><span style=display:flex><span>I: Please securely store this generated password. If you lose this password you can delete and recreate the cluster admin user.
</span></span><span style=display:flex><span>I: To login, run the following command:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc login https://api.rosa-4fgbq.qrdf.p1.openshiftapps.com:6443 --username cluster-admin --password [clusteradminpassword]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>I: It may take up to 5 minutes for the account to become active.
</span></span></code></pre></div><p>Save the login command somewhere. Also take note of the password for your cluster-admin user.</p><p>Make sure to use the entire password when copying and pasting the command!</p></li><li><p>Save an environment variable for your admin password (copy the password from above making sure to copy the entire password):</p><p>Note this box will not automatically copy the command for you. You need to write the command yourself using the password from your environment.</p><pre><code> export ADMIN_PASSWORD=[clusteradminpassword]
</code></pre><p>Save the admin password in your <code>.bashrc</code></p><pre><code> echo &quot;export ADMIN_PASSWORD=$ADMIN_PASSWORD&quot; &gt;&gt;$HOME/.bashrc
</code></pre></li><li><p>Copy the login command returned to you in the previous step and paste that into your terminal. This should log you into the cluster via the CLI so you can start using the cluster (answer <code>y</code> when prompted if you want to accept the certificate).</p><pre><code> oc login https://api.rosa-4fgbq.qrdf.p1.openshiftapps.com:6443 --username cluster-admin --password [clusteradminpassword]
</code></pre><p>Sample Output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tpl data-lang=tpl><span style=display:flex><span>The server uses a certificate signed by an unknown authority.
</span></span><span style=display:flex><span>You can bypass the certificate check, but any data you send to the server could be intercepted by others.
</span></span><span style=display:flex><span>Use insecure connections? (y/n): y
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WARNING: Using insecure TLS client config. Setting this option is not supported!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Login successful.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>You have access to 100 projects, the list has been suppressed. You can list all projects with &#39;oc projects&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Using project &#34;default&#34;.
</span></span><span style=display:flex><span>Welcome! See &#39;oc help&#39; to get started.
</span></span></code></pre></div><p>If you get an error that the Login failed (401 Unauthorized) wait a few seconds and then try again. It takes a few minutes for the cluster authentication operator to update itself after creating the cluster-admin user.</p></li><li><p>To check that you are logged in as the admin user you can run <code>oc whoami</code></p><pre><code> oc whoami
</code></pre><p>Sample Output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tpl data-lang=tpl><span style=display:flex><span>cluster-admin
</span></span></code></pre></div></li><li><p>You can also confirm by running the following command. Only a cluster-admin user can run this without errors.</p><pre><code> oc get pod -n openshift-ingress
</code></pre><p>Sample Output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tpl data-lang=tpl><span style=display:flex><span>NAME                              READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>router-default-7994f6fd58-8cl45   1/1     Running   0          102s
</span></span><span style=display:flex><span>router-default-7994f6fd58-z6gpm   1/1     Running   0          102s
</span></span></code></pre></div></li><li><p>You can now access the cluster with this local admin user. Though, for production use, it is highly recommended to set up an external identity provider.</p></li></ol><h2 id=login-to-the-openshift-web-console>Login to the OpenShift Web Console
<a class=anchor href=#login-to-the-openshift-web-console>#</a></h2><p>Next, let’s log in to the OpenShift Web Console. To do so, follow the below steps:</p><ol><li><p>First, we’ll need to grab your cluster’s web console URL. To do so, run the following command:</p><pre><code> oc whoami --show-console
</code></pre><p>Sample Output</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-tpl data-lang=tpl><span style=display:flex><span>https://console-openshift-console.apps.rosa-z8ssd.ls3a.p1.openshiftapps.com/
</span></span></code></pre></div></li><li><p>Next, open the printed URL in a web browser</p></li><li><p>Click on the <code>cluster-admin</code> identity provider.</p></li><li><p>Enter the username (<code>cluster-admin</code>) and password from the previous section (use <code>echo $ADMIN_PASSWORD</code> to remind yourself what the password is in case you forgot).</p></li></ol><p>Congratulations! You’re now logged into the cluster and ready to move on to the workshop content.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#create-a-local-admin-user-for-cluster-access>Create a Local Admin User for Cluster Access</a></li><li><a href=#login-to-the-openshift-web-console>Login to the OpenShift Web Console</a></li></ul></nav></div></aside></main></body></html>